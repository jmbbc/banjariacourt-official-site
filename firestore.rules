rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Public read for content and reports; admin writes restricted by UID OR email allowlist
    function isAdmin() {
      return request.auth != null && (
        request.auth.uid in [
          '7TwgD2Fu8MR6e8qu7Wp5TUrVbfJ3', // email/password admin (diberi)
          'S77OVnIGSghWyXPVDPVzCy9ZSas2'  // email/password admin (current login)
        ] ||
        request.auth.token.email in [
          'jmbbanjariacourt.agm2@gmail.com',
          'jmbbanjariacourt.agm@gmail.com'
        ]
      );
    }

    match /content/{section} {
      allow read: if true;
      allow write: if isAdmin();
    }

    match /reports/{doc} {
      allow read: if true;
      allow write: if isAdmin();
    }

    // Default: deny everything else
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
